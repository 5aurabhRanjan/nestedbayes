<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>NestedBayes by ngoodman</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>NestedBayes</h1>
          <h2>Thinking through nested conditional inference in WebPPL.</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/ngoodman/nestedbayes/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/ngoodman/nestedbayes/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/ngoodman/nestedbayes" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a id="nested-bayesian-inference" class="anchor" href="#nested-bayesian-inference" aria-hidden="true"><span class="octicon octicon-link"></span></a>Nested Bayesian Inference</h1>

<p>Thinking through "nested-query" <a href="http://webppl.org">WebPPL</a> models -- those where conditioning is nested inside conditioning. These are called doubly intractable in stats.</p>

<p>Examples include Bayesian social cognition models (including pragmatics models), Bayesian data analysis of Bayesian cognitive models, and posterior inference of model parameters for (partially) undirected models (such as learning in semantic parsers).</p>

<h2>
<a id="surrogate-caching-method" class="anchor" href="#surrogate-caching-method" aria-hidden="true"><span class="octicon octicon-link"></span></a>Surrogate (caching) method</h2>

<p>The approach currently explored is to create a gaussian process (GP) surrogate function for the probability of a return value from the sub-query with given params (or for its normalizing constant, which is usually the hard part). We should test this approach more thoroughly, and compare to other techniques.</p>

<p>The surrogate is implemented by providing a generic GP-cache function that is applied to the <code>erp.score</code> of the marginal returned from the sub-query. When the cached function is called with given args, it: evaluates the GP, determines if the uncertainty (estimate variance) is above a threshold, if so it evaluates the underlying function and updates the GP, it then returns the GP estimate (mean) of the function value. </p>

<p>Currently the uncertainty threshold is a fixed parameter. It could potentially be adapted based on desired computation rate of the cached function, or other objectives. If the uncertainty threshold falls (quickly enough) an MCMC algorithms using these estimates will remain assymptotically unbiased (under some assumptions, such as boundedness of the cahced function domain).</p>

<p>One relatively easy extension would be to provide the gradient of the GP, in order to make this surrogate method compatible with HMC (which requires gradients). This seems like a good idea for cases like Bayesian data analysis of a cognitive model, where there are often a lot of continuous parameters (e.g. subject-wise and item-wise random effects).</p>

<h2>
<a id="other-methods" class="anchor" href="#other-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other methods</h2>

<p>There are a number of other approaches for doubly-intractible MCMC, and it would be worth thinking more generally. For example, in <a href="http://arxiv.org/pdf/1206.6848.pdf">MCMC for doubly-intractable distributions</a> they point out that an unbiased estimator for the intractable likelihood is enough to get an unbiased MH for the whole model (via pseudo-marginal MH). <a href="http://xxx.tau.ac.il/pdf/1306.4032.pdf">This one</a> extends these ideas, as well as reviewing current approaches.</p>
        </section>

        <footer>
          NestedBayes is maintained by <a href="https://github.com/ngoodman">ngoodman</a><br>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>